# Pet.py è§£æ„é‡æ„ä»»åŠ¡æ¸…å•

## æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº† `src/frontend/pet.py` çš„è§£æ„é‡æ„ä»»åŠ¡æ¸…å•ã€‚

**åˆ›å»ºæ—¥æœŸï¼š** 2026-01-08  
**æœ€åæ›´æ–°ï¼š** 2026-01-08  
**å‚è€ƒæ–‡æ¡£ï¼š** [a1-LIVE2D_REFACTORING_PLAN.md](./a1-LIVE2D_REFACTORING_PLAN.md)

---

## ä¸€ã€å½“å‰ä»£ç é—®é¢˜åˆ†æ

### 1.1 ä¸»è¦é—®é¢˜

#### é—®é¢˜ 1ï¼šå•ä¸€èŒè´£åŸåˆ™ä¸¥é‡è¿å
- **ç°è±¡**ï¼š`DesktopPet` ç±»æ‰¿æ‹…äº†çª—å£ã€æ‰˜ç›˜ã€æ°”æ³¡ã€æˆªå›¾ã€ç§»åŠ¨ã€äº‹ä»¶ã€æ¸²æŸ“ã€çŠ¶æ€ã€é…ç½®ç­‰ 9+ ä¸ªèŒè´£
- **å½±å“**ï¼šä»£ç è€¦åˆåº¦é«˜ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ï¼Œä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½å¯èƒ½å½±å“å…¶ä»–åŠŸèƒ½

#### é—®é¢˜ 2ï¼šæ¸²æŸ“æ¶æ„åƒµåŒ–
- **ç°è±¡**ï¼šä½¿ç”¨é™æ€ QLabel æ˜¾ç¤ºï¼Œæ— æ³•æ”¯æŒåŠ¨æ€åŠ¨ç”»
- **å½±å“**ï¼šæ— æ³•æ‰©å±•åˆ° Live2Dï¼Œéš¾ä»¥åˆ‡æ¢ä¸åŒçš„æ˜¾ç¤ºæ¨¡å¼

#### é—®é¢˜ 3ï¼šå­çª—å£ç®¡ç†æ··ä¹±
- **ç°è±¡**ï¼šæ‰€æœ‰å­çª—å£ï¼ˆæ°”æ³¡ã€èœå•ã€è¾“å…¥æ¡†ï¼‰éƒ½ä¾èµ– DesktopPet å®ä¾‹
- **å½±å“**ï¼šéš¾ä»¥æµ‹è¯•å’Œå¤ç”¨å­çª—å£ç»„ä»¶ï¼Œçª—å£ä½ç½®åŒæ­¥é€»è¾‘åˆ†æ•£

#### é—®é¢˜ 4ï¼šäº‹ä»¶å¤„ç†ç¼ºä¹åˆ†å±‚
- **ç°è±¡**ï¼šæ‰€æœ‰äº‹ä»¶å¤„ç†éƒ½åœ¨ DesktopPet ç±»ä¸­ï¼Œä¸šåŠ¡é€»è¾‘ä¸ UI é€»è¾‘æ··åˆ
- **å½±å“**ï¼šäº‹ä»¶å¤„ç†é€»è¾‘å¤æ‚ï¼Œéš¾ä»¥è¿½è¸ªäº‹ä»¶æµï¼Œç¼ºä¹ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†

### 1.2 ä»£ç ç»“æ„åˆ†æ

```python
DesktopPet ç±»ï¼ˆçº¦ 600+ è¡Œï¼‰
â”œâ”€â”€ __init__()                    # åˆå§‹åŒ–ï¼ˆ100+ è¡Œï¼‰
â”‚   â”œâ”€â”€ init_ui()                # UI åˆå§‹åŒ–
â”‚   â”œâ”€â”€ init_tray_icon()         # æ‰˜ç›˜å›¾æ ‡åˆå§‹åŒ–
â”‚   â”œâ”€â”€ æ°”æ³¡ç³»ç»Ÿåˆå§‹åŒ–
â”‚   â”œâ”€â”€ å¿«æ·é”®åˆå§‹åŒ–
â”‚   â””â”€â”€ å®šæ—¶å™¨åˆå§‹åŒ–
â”œâ”€â”€ çª—å£ç®¡ç†ï¼ˆ50+ è¡Œï¼‰
â”‚   â”œâ”€â”€ show_pet() / hide_pet()
â”‚   â””â”€â”€ åˆå§‹ä½ç½®è®¾ç½®
â”œâ”€â”€ æ‰˜ç›˜ç®¡ç†ï¼ˆ100+ è¡Œï¼‰
â”‚   â”œâ”€â”€ init_tray_icon()
â”‚   â”œâ”€â”€ toggle_console()
â”‚   â”œâ”€â”€ show_console() / hide_console()
â”‚   â”œâ”€â”€ update_terminal_menu_state()
â”‚   â””â”€â”€ safe_quit()
â”œâ”€â”€ æ°”æ³¡ç³»ç»Ÿï¼ˆ80+ è¡Œï¼‰
â”‚   â”œâ”€â”€ show_message()
â”‚   â”œâ”€â”€ del_message_bubble()
â”‚   â”œâ”€â”€ show_chat_input()
â”‚   â””â”€â”€ handle_user_input()
â”œâ”€â”€ æˆªå›¾åŠŸèƒ½ï¼ˆ80+ è¡Œï¼‰
â”‚   â”œâ”€â”€ start_screenshot()
â”‚   â”œâ”€â”€ handle_screenshot()
â”‚   â”œâ”€â”€ start_peeking()
â”‚   â”œâ”€â”€ stop_peeking()
â”‚   â””â”€â”€ _on_peek_timer()
â”œâ”€â”€ ç§»åŠ¨ç®¡ç†ï¼ˆ60+ è¡Œï¼‰
â”‚   â”œâ”€â”€ mousePressEvent()
â”‚   â”œâ”€â”€ mouseReleaseEvent()
â”‚   â””â”€â”€ _on_position_changed()
â”œâ”€â”€ äº‹ä»¶å¤„ç†ï¼ˆ30+ è¡Œï¼‰
â”‚   â”œâ”€â”€ mouseDoubleClickEvent()
â”‚   â””â”€â”€ contextMenuEvent()
â”œâ”€â”€ æ¸²æŸ“ï¼ˆ20+ è¡Œï¼‰
â”‚   â””â”€â”€ init_ui() ä¸­çš„å›¾ç‰‡åŠ è½½
â”œâ”€â”€ çŠ¶æ€ç®¡ç†ï¼ˆ50+ è¡Œï¼‰
â”‚   â”œâ”€â”€ lock_window()
â”‚   â”œâ”€â”€ unlock_window()
â”‚   â”œâ”€â”€ toggle_lock()
â”‚   â””â”€â”€ hide_all_bubble()
â””â”€â”€ é…ç½®ç®¡ç†ï¼ˆ30+ è¡Œï¼‰
    â”œâ”€â”€ change_scale()
    â””â”€â”€ é…ç½®æ–‡ä»¶è¯»å†™
```

---

## äºŒã€è§£æ„é‡æ„æ–¹æ¡ˆ

### 2.1 æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Presentation Layer (UI å±‚)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DesktopPet  â”‚  â”‚ BubbleSystem â”‚  â”‚ TrayManager  â”‚  â”‚
â”‚  â”‚   (çª—å£)     â”‚  â”‚  (æ°”æ³¡ç³»ç»Ÿ)   â”‚  â”‚  (æ‰˜ç›˜ç®¡ç†)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                 â”‚                 â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                 â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â–¼                 â–¼                 â–¼        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚         â”‚      Presentation Layer (Core)       â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚RenderManager â”‚  â”‚EventManager  â”‚  â”‚ StateManager â”‚ â”‚
â”‚  â”‚  (æ¸²æŸ“ç®¡ç†)  â”‚  â”‚  (äº‹ä»¶ç®¡ç†)  â”‚  â”‚  (çŠ¶æ€ç®¡ç†)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                 â”‚                 â”‚        â”‚
â”‚           â–¼                 â–¼                 â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   IRenderer  â”‚  â”‚ IEventHandlerâ”‚  â”‚   IState     â”‚ â”‚
â”‚  â”‚  (æ¸²æŸ“æ¥å£)  â”‚  â”‚ (äº‹ä»¶æ¥å£)   â”‚  â”‚  (çŠ¶æ€æ¥å£)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                 â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â–¼                 â–¼                 â–¼        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚            Business Layer (ä¸šåŠ¡å±‚)            â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Live2DRendererâ”‚ â”‚StaticRendererâ”‚ â”‚AnimationControllerâ”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                 â”‚                 â”‚        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Live2DModel â”‚  â”‚ ImageLoader  â”‚ â”‚ MotionManager â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 èŒè´£åˆ†ç¦»æ–¹æ¡ˆ

#### åˆ†ç¦» 1ï¼šæ¸²æŸ“ç®¡ç†ï¼ˆRenderManagerï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- å›¾ç‰‡åŠ è½½å’Œæ˜¾ç¤º
- æ¸²æŸ“æ¨¡å¼åˆ‡æ¢ï¼ˆé™æ€/Live2Dï¼‰
- åŠ¨ç”»çŠ¶æ€è®¾ç½®
- è¡¨æƒ…è®¾ç½®
- é¼ æ ‡ç§»åŠ¨å¤„ç†ï¼ˆç”¨äºæ³¨è§†æ•ˆæœï¼‰

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/core/render/interfaces.py` - æ¸²æŸ“å™¨æ¥å£ï¼ˆIRendererï¼‰
- `src/frontend/core/render/static_renderer.py` - é™æ€å›¾ç‰‡æ¸²æŸ“å™¨
- `src/frontend/core/render/live2d_renderer.py` - Live2D æ¸²æŸ“å™¨
- `src/frontend/core/managers/render_manager.py` - æ¸²æŸ“ç®¡ç†å™¨

#### åˆ†ç¦» 2ï¼šäº‹ä»¶ç®¡ç†ï¼ˆEventManagerï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- é¼ æ ‡æŒ‰ä¸‹å¤„ç†
- é¼ æ ‡é‡Šæ”¾å¤„ç†
- é¼ æ ‡ç§»åŠ¨å¤„ç†
- é¼ æ ‡åŒå‡»å¤„ç†
- å³é”®èœå•æ˜¾ç¤º
- çª—å£ç§»åŠ¨ç®¡ç†

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/core/managers/event_manager.py` - äº‹ä»¶ç®¡ç†å™¨

#### åˆ†ç¦» 3ï¼šçŠ¶æ€ç®¡ç†ï¼ˆStateManagerï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- çª—å£é”å®š/è§£é”
- çª—å£æ˜¾ç¤º/éšè—
- ç»ˆç«¯æ˜¾ç¤º/éšè—
- çª¥å±çŠ¶æ€ç®¡ç†
- çŠ¶æ€æŒä¹…åŒ–

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/core/managers/state_manager.py` - çŠ¶æ€ç®¡ç†å™¨

#### åˆ†ç¦» 4ï¼šæ°”æ³¡ç³»ç»Ÿï¼ˆBubbleSystemï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- æ¶ˆæ¯æ°”æ³¡ç®¡ç†
- è¾“å…¥æ°”æ³¡ç®¡ç†
- æ°”æ³¡ä½ç½®åŒæ­¥
- æ°”æ³¡æ˜¾ç¤º/éšè—

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/presentation/bubble_system.py` - æ°”æ³¡ç³»ç»Ÿç®¡ç†å™¨

#### åˆ†ç¦» 5ï¼šæˆªå›¾ç®¡ç†ï¼ˆScreenshotManagerï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- åŒºåŸŸæˆªå›¾
- æˆªå›¾å¤„ç†
- çª¥å±åŠŸèƒ½
- å®šæ—¶å™¨ç®¡ç†

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/presentation/screenshot_manager.py` - æˆªå›¾ç®¡ç†å™¨

#### åˆ†ç¦» 6ï¼šæ‰˜ç›˜ç®¡ç†ï¼ˆTrayManagerï¼‰
**ä» DesktopPet æå–çš„èŒè´£ï¼š**
- ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ç®¡ç†
- æ‰˜ç›˜èœå•åˆ›å»º
- ç»ˆç«¯æ§åˆ¶
- é€€å‡ºæ§åˆ¶

**æ–°å»ºæ–‡ä»¶ï¼š**
- `src/frontend/presentation/tray_manager.py` - æ‰˜ç›˜ç®¡ç†å™¨

#### åˆ†ç¦» 7ï¼šä¸»çª—å£ç®€åŒ–ï¼ˆDesktopPetï¼‰
**ä¿ç•™çš„èŒè´£ï¼š**
- çª—å£ç”Ÿå‘½å‘¨æœŸç®¡ç†
- å­çª—å£å®¹å™¨ç®¡ç†
- äº‹ä»¶å§”æ‰˜
- ä¾èµ–æ³¨å…¥

**é‡æ„æ–‡ä»¶ï¼š**
- `src/frontend/pet.py` â†’ `src/frontend/presentation/refactored_pet.py`

---

## ä¸‰ã€é‡æ„å®æ–½è®¡åˆ’

### é˜¶æ®µ 1ï¼šåŸºç¡€æ¶æ„å‡†å¤‡ï¼ˆ1-2 å¤©ï¼‰

#### 1.1 åˆ›å»ºç›®å½•ç»“æ„
- [ ] ç¡®è®¤ç°æœ‰ç›®å½•ç»“æ„
- [ ] åˆ›å»º `src/frontend/core/render/` ç›®å½•
- [ ] åˆ›å»º `src/frontend/core/managers/` ç›®å½•
- [ ] åˆ›å»º `src/frontend/presentation/` ç›®å½•
- [ ] åˆ›å»º `src/frontend/data/` ç›®å½•

#### 1.2 åˆ›å»ºæ¥å£å®šä¹‰
- [ ] åˆ›å»º `src/frontend/core/render/__init__.py`
- [ ] åˆ›å»º `src/frontend/core/render/interfaces.py`
  - [ ] å®šä¹‰ `IRenderer` æŠ½è±¡åŸºç±»
  - [ ] å®šä¹‰ `initialize()` æ–¹æ³•
  - [ ] å®šä¹‰ `attach()` æ–¹æ³•
  - [ ] å®šä¹‰ `cleanup()` æ–¹æ³•
  - [ ] å®šä¹‰ `set_animation_state()` æ–¹æ³•
  - [ ] å®šä¹‰ `set_expression()` æ–¹æ³•
  - [ ] å®šä¹‰ `on_mouse_move()` æ–¹æ³•

#### 1.3 åˆ›å»ºç®¡ç†å™¨æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/core/managers/__init__.py`
- [ ] åˆ›å»º `src/frontend/core/managers/render_manager.py` æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/core/managers/event_manager.py` æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/core/managers/state_manager.py` æ¡†æ¶

#### 1.4 åˆ›å»ºå­ç®¡ç†å™¨æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/presentation/__init__.py`
- [ ] åˆ›å»º `src/frontend/presentation/bubble_system.py` æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/presentation/screenshot_manager.py` æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/presentation/tray_manager.py` æ¡†æ¶

#### 1.5 å¤‡ä»½ç°æœ‰ä»£ç 
- [ ] å¤‡ä»½ `src/frontend/pet.py` â†’ `src/frontend/pet.py.backup`
- [ ] å¤‡ä»½ `config.toml` â†’ `config.toml.backup`

### é˜¶æ®µ 2ï¼šæ¸²æŸ“ç³»ç»Ÿå®ç°ï¼ˆ2-3 å¤©ï¼‰

#### 2.1 å®ç°é™æ€æ¸²æŸ“å™¨
- [ ] åˆ›å»º `src/frontend/core/render/static_renderer.py`
  - [ ] å®ç° `StaticRenderer` ç±»
  - [ ] å®ç° `initialize()` æ–¹æ³•
  - [ ] å®ç° `attach()` æ–¹æ³•
  - [ ] å®ç° `cleanup()` æ–¹æ³•
  - [ ] å®ç° `set_animation_state()` æ–¹æ³•ï¼ˆç©ºå®ç°æˆ–è­¦å‘Šï¼‰
  - [ ] å®ç° `set_expression()` æ–¹æ³•ï¼ˆç©ºå®ç°æˆ–è­¦å‘Šï¼‰
  - [ ] å®ç° `on_mouse_move()` æ–¹æ³•ï¼ˆç©ºå®ç°ï¼‰
  - [ ] æ”¯æŒå›¾ç‰‡ç¼©æ”¾ï¼ˆä½¿ç”¨ `scale_factor`ï¼‰
  - [ ] æ”¯æŒå›¾ç‰‡ç¼“å­˜ï¼ˆå¯é€‰ï¼‰

#### 2.2 å®ç° Live2D æ¸²æŸ“å™¨æ¡†æ¶
- [ ] åˆ›å»º `src/frontend/core/render/live2d_renderer.py`
  - [ ] å®ç° `Live2DRenderer` ç±»
  - [ ] å®ç° `initialize()` æ–¹æ³•æ¡†æ¶
  - [ ] å®ç° `attach()` æ–¹æ³•æ¡†æ¶
  - [ ] å®ç° `cleanup()` æ–¹æ³•æ¡†æ¶
  - [ ] å®ç° `set_animation_state()` æ–¹æ³•æ¡†æ¶
  - [ ] å®ç° `set_expression()` æ–¹æ³•æ¡†æ¶
  - [ ] å®ç° `on_mouse_move()` æ–¹æ³•æ¡†æ¶
  - [ ] æ·»åŠ  Live2D åº“æ£€æµ‹é€»è¾‘
  - [ ] æ·»åŠ ä¼˜é›…é™çº§æœºåˆ¶ï¼ˆLive2D ä¸å¯ç”¨æ—¶ä½¿ç”¨é™æ€æ¸²æŸ“ï¼‰

#### 2.3 å®ç°æ¸²æŸ“ç®¡ç†å™¨
- [ ] å®Œå–„ `src/frontend/core/managers/render_manager.py`
  - [ ] å®ç° `RenderManager` ç±»
  - [ ] å®ç°æ¸²æŸ“å™¨åˆ›å»ºé€»è¾‘
  - [ ] å®ç°æ¸²æŸ“æ¨¡å¼åˆ‡æ¢
  - [ ] å®ç°åŠ¨ç”»çŠ¶æ€è®¾ç½®
  - [ ] å®ç°è¡¨æƒ…è®¾ç½®
  - [ ] å®ç°é¼ æ ‡ç§»åŠ¨å¤„ç†
  - [ ] æ·»åŠ é…ç½®åŠ è½½åŠŸèƒ½
  - [ ] æ·»åŠ é”™è¯¯å¤„ç†

#### 2.4 æµ‹è¯•æ¸²æŸ“ç³»ç»Ÿ
- [ ] æµ‹è¯•é™æ€æ¸²æŸ“å™¨åˆå§‹åŒ–
- [ ] æµ‹è¯•é™æ€æ¸²æŸ“å™¨å›¾ç‰‡æ˜¾ç¤º
- [ ] æµ‹è¯•æ¸²æŸ“å™¨åˆ‡æ¢
- [ ] æµ‹è¯•åŠ¨ç”»çŠ¶æ€è®¾ç½®
- [ ] æµ‹è¯•è¡¨æƒ…è®¾ç½®

### é˜¶æ®µ 3ï¼šç®¡ç†å™¨å®ç°ï¼ˆ3-4 å¤©ï¼‰

#### 3.1 å®ç°äº‹ä»¶ç®¡ç†å™¨
- [ ] å®Œå–„ `src/frontend/core/managers/event_manager.py`
  - [ ] å®ç° `EventManager` ç±»
  - [ ] å®ç°é¼ æ ‡æŒ‰ä¸‹å¤„ç†
  - [ ] å®ç°é¼ æ ‡é‡Šæ”¾å¤„ç†
  - [ ] å®ç°é¼ æ ‡ç§»åŠ¨å¤„ç†
  - [ ] å®ç°é¼ æ ‡åŒå‡»å¤„ç†
  - [ ] å®ç°å³é”®èœå•æ˜¾ç¤º
  - [ ] å®ç°çª—å£ç§»åŠ¨ç®¡ç†
  - [ ] è¿ç§» `MoveWorker` çº¿ç¨‹

#### 3.2 å®ç°çŠ¶æ€ç®¡ç†å™¨
- [ ] å®Œå–„ `src/frontend/core/managers/state_manager.py`
  - [ ] å®ç° `StateManager` ç±»
  - [ ] å®ç°çª—å£é”å®š/è§£é”
  - [ ] å®ç°çª—å£æ˜¾ç¤º/éšè—
  - [ ] å®ç°ç»ˆç«¯æ˜¾ç¤º/éšè—
  - [ ] å®ç°çª¥å±çŠ¶æ€ç®¡ç†
  - [ ] å®ç°çŠ¶æ€æŒä¹…åŒ–
  - [ ] å®ç°çŠ¶æ€é€šçŸ¥æœºåˆ¶

#### 3.3 å®ç°æ°”æ³¡ç³»ç»Ÿ
- [ ] å®Œå–„ `src/frontend/presentation/bubble_system.py`
  - [ ] å®ç° `BubbleSystem` ç±»
  - [ ] æ•´åˆ `SpeechBubbleList`
  - [ ] æ•´åˆ `BubbleInput`
  - [ ] æ•´åˆ `BubbleMenu`
  - [ ] å®ç°æ°”æ³¡ä½ç½®åŒæ­¥
  - [ ] å®ç°æ°”æ³¡æ˜¾ç¤º/éšè—
  - [ ] è®¢é˜…çª—å£ä½ç½®å˜åŒ–äº‹ä»¶

#### 3.4 å®ç°æˆªå›¾ç®¡ç†å™¨
- [ ] å®Œå–„ `src/frontend/presentation/screenshot_manager.py`
  - [ ] å®ç° `ScreenshotManager` ç±»
  - [ ] æ•´åˆ `ScreenshotSelector`
  - [ ] å®ç°æˆªå›¾åŠŸèƒ½
  - [ ] å®ç°çª¥å±åŠŸèƒ½
  - [ ] å®ç°å®šæ—¶å™¨ç®¡ç†
  - [ ] å®ç°å¿«æ·é”®å¤„ç†

#### 3.5 å®ç°æ‰˜ç›˜ç®¡ç†å™¨
- [ ] å®Œå–„ `src/frontend/presentation/tray_manager.py`
  - [ ] å®ç° `TrayManager` ç±»
  - [ ] å®ç°ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡ç®¡ç†
  - [ ] å®ç°æ‰˜ç›˜èœå•åˆ›å»º
  - [ ] å®ç°ç»ˆç«¯æ§åˆ¶
  - [ ] å®ç°é€€å‡ºæ§åˆ¶
  - [ ] å®ç°èœå•æ ·å¼åŠ è½½

#### 3.6 æµ‹è¯•ç®¡ç†å™¨
- [ ] æµ‹è¯•äº‹ä»¶ç®¡ç†å™¨
- [ ] æµ‹è¯•çŠ¶æ€ç®¡ç†å™¨
- [ ] æµ‹è¯•æ°”æ³¡ç³»ç»Ÿ
- [ ] æµ‹è¯•æˆªå›¾ç®¡ç†å™¨
- [ ] æµ‹è¯•æ‰˜ç›˜ç®¡ç†å™¨

### é˜¶æ®µ 4ï¼šä¸»çª—å£é‡æ„ï¼ˆ2-3 å¤©ï¼‰

#### 4.1 åˆ›å»ºç®€åŒ–ç‰ˆä¸»çª—å£
- [ ] åˆ›å»º `src/frontend/presentation/refactored_pet.py`
  - [ ] å®ç° `DesktopPet` ç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰
  - [ ] å®ç°çª—å£åˆå§‹åŒ–
  - [ ] å®ç°ä¾èµ–æ³¨å…¥
  - [ ] å®ç°äº‹ä»¶å§”æ‰˜
  - [ ] å®ç°å­ç³»ç»Ÿåˆå§‹åŒ–
  - [ ] å®ç°æ¸²æŸ“å®¹å™¨

#### 4.2 è¿ç§»çª—å£ç®¡ç†é€»è¾‘
- [ ] è¿ç§»çª—å£å±æ€§è®¾ç½®
- [ ] è¿ç§»çª—å£æ ‡å¿—è®¾ç½®
- [ ] è¿ç§»çª—å£å¤§å°è®¾ç½®
- [ ] è¿ç§»é€æ˜èƒŒæ™¯è®¾ç½®
- [ ] è¿ç§»åˆå§‹ä½ç½®è®¾ç½®

#### 4.3 è¿ç§»å­çª—å£ç®¡ç†
- [ ] è¿ç§»æ°”æ³¡ç³»ç»Ÿé›†æˆ
- [ ] è¿ç§»æˆªå›¾ç³»ç»Ÿé›†æˆ
- [ ] è¿ç§»æ‰˜ç›˜ç³»ç»Ÿé›†æˆ
- [ ] è¿ç§»å³é”®èœå•

#### 4.4 è¿ç§»åŠŸèƒ½é€»è¾‘
- [ ] è¿ç§»æ¶ˆæ¯æ˜¾ç¤ºé€»è¾‘
- [ ] è¿ç§»ç¼©æ”¾è°ƒæ•´é€»è¾‘
- [ ] è¿ç§»é…ç½®æ–‡ä»¶è¯»å†™
- [ ] è¿ç§»å®šæ—¶å™¨é€»è¾‘

#### 4.5 æµ‹è¯•ä¸»çª—å£
- [ ] æµ‹è¯•çª—å£åˆå§‹åŒ–
- [ ] æµ‹è¯•çª—å£æ˜¾ç¤º/éšè—
- [ ] æµ‹è¯•çª—å£æ‹–åŠ¨
- [ ] æµ‹è¯•çª—å£é”å®š/è§£é”
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

### é˜¶æ®µ 5ï¼šé›†æˆæµ‹è¯•ï¼ˆ1-2 å¤©ï¼‰

#### 5.1 åŠŸèƒ½æµ‹è¯•
- [ ] æµ‹è¯•ç¨‹åºå¯åŠ¨
- [ ] æµ‹è¯•çª—å£æ˜¾ç¤º
- [ ] æµ‹è¯•çª—å£æ‹–åŠ¨
- [ ] æµ‹è¯•çª—å£é”å®š
- [ ] æµ‹è¯•æ¶ˆæ¯æ˜¾ç¤º
- [ ] æµ‹è¯•è¾“å…¥æ¡†
- [ ] æµ‹è¯•æˆªå›¾åŠŸèƒ½
- [ ] æµ‹è¯•æ‰˜ç›˜åŠŸèƒ½
- [ ] æµ‹è¯•å³é”®èœå•
- [ ] æµ‹è¯•ç¼©æ”¾è°ƒæ•´

#### 5.2 é›†æˆæµ‹è¯•
- [ ] æµ‹è¯•ç®¡ç†å™¨ä¹‹é—´çš„åä½œ
- [ ] æµ‹è¯•äº‹ä»¶æµè½¬
- [ ] æµ‹è¯•çŠ¶æ€åŒæ­¥
- [ ] æµ‹è¯•èµ„æºç®¡ç†

#### 5.3 æ€§èƒ½æµ‹è¯•
- [ ] æµ‹è¯• CPU å ç”¨ç‡
- [ ] æµ‹è¯•å†…å­˜å ç”¨
- [ ] æµ‹è¯•å“åº”é€Ÿåº¦
- [ ] æµ‹è¯•ç¨³å®šæ€§

#### 5.4 ä¿®å¤é—®é¢˜
- [ ] ä¿®å¤å‘ç°çš„é—®é¢˜
- [ ] ä¼˜åŒ–æ€§èƒ½
- [ ] å®Œå–„é”™è¯¯å¤„ç†

### é˜¶æ®µ 6ï¼šæ–‡æ¡£å’Œæ¸…ç†ï¼ˆ1 å¤©ï¼‰

#### 6.1 æ›´æ–°æ–‡æ¡£
- [ ] æ›´æ–° `docs/a1-LIVE2D_REFACTORING_PLAN.md`
- [ ] æ›´æ–° `docs/t1-TODOLIST.md`
- [ ] æ›´æ–° `README.md`
- [ ] ç¼–å†™æ¶æ„è¯´æ˜æ–‡æ¡£
- [ ] ç¼–å†™ä½¿ç”¨æŒ‡å—

#### 6.2 ä»£ç æ¸…ç†
- [ ] åˆ é™¤æ—§ä»£ç 
- [ ] æ¸…ç†æ³¨é‡Š
- [ ] ç»Ÿä¸€ä»£ç é£æ ¼
- [ ] å®Œå–„æ–‡æ¡£å­—ç¬¦ä¸²

#### 6.3 å‡†å¤‡å‘å¸ƒ
- [ ] æ›´æ–° CHANGELOG
- [ ] æ›´æ–°ç‰ˆæœ¬å·
- [ ] åˆ›å»º Git æ ‡ç­¾
- [ ] å‘å¸ƒæ–°ç‰ˆæœ¬

---

## å››ã€æ–‡ä»¶æ˜ å°„å…³ç³»

### åŸå§‹æ–‡ä»¶ â†’ æ–°æ–‡ä»¶

| åŸå§‹æ–‡ä»¶ | æ–°æ–‡ä»¶ | è¯´æ˜ |
|----------|--------|------|
| `src/frontend/pet.py` | `src/frontend/presentation/refactored_pet.py` | ä¸»çª—å£é‡æ„ |
| `src/frontend/pet.py` (æ¸²æŸ“éƒ¨åˆ†) | `src/frontend/core/render/static_renderer.py` | é™æ€æ¸²æŸ“å™¨ |
| `src/frontend/pet.py` (æ¸²æŸ“éƒ¨åˆ†) | `src/frontend/core/render/live2d_renderer.py` | Live2D æ¸²æŸ“å™¨ |
| `src/frontend/pet.py` (äº‹ä»¶éƒ¨åˆ†) | `src/frontend/core/managers/event_manager.py` | äº‹ä»¶ç®¡ç†å™¨ |
| `src/frontend/pet.py` (çŠ¶æ€éƒ¨åˆ†) | `src/frontend/core/managers/state_manager.py` | çŠ¶æ€ç®¡ç†å™¨ |
| `src/frontend/pet.py` (æ°”æ³¡éƒ¨åˆ†) | `src/frontend/presentation/bubble_system.py` | æ°”æ³¡ç³»ç»Ÿ |
| `src/frontend/pet.py` (æˆªå›¾éƒ¨åˆ†) | `src/frontend/presentation/screenshot_manager.py` | æˆªå›¾ç®¡ç†å™¨ |
| `src/frontend/pet.py` (æ‰˜ç›˜éƒ¨åˆ†) | `src/frontend/presentation/tray_manager.py` | æ‰˜ç›˜ç®¡ç†å™¨ |

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|----------|------|
| `src/frontend/core/render/interfaces.py` | æ¸²æŸ“å™¨æ¥å£ |
| `src/frontend/core/managers/render_manager.py` | æ¸²æŸ“ç®¡ç†å™¨ |
| `src/frontend/core/managers/__init__.py` | ç®¡ç†å™¨æ¨¡å—åˆå§‹åŒ– |
| `src/frontend/core/render/__init__.py` | æ¸²æŸ“å™¨æ¨¡å—åˆå§‹åŒ– |
| `src/frontend/presentation/__init__.py` | UI å±‚æ¨¡å—åˆå§‹åŒ– |

---

## äº”ã€é£é™©è¯„ä¼°

### é«˜é£é™©é¡¹

| é£é™©é¡¹ | å½±å“ | æ¦‚ç‡ | åº”å¯¹æªæ–½ |
|--------|------|------|----------|
| ç°æœ‰åŠŸèƒ½ç ´å | é«˜ | ä¸­ | å®Œå–„çš„å•å…ƒæµ‹è¯•ï¼Œé€æ­¥è¿ç§» |
| ç®¡ç†å™¨ä¹‹é—´é€šä¿¡é—®é¢˜ | é«˜ | ä¸­ | ä½¿ç”¨ä¿¡å·æ§½æœºåˆ¶ï¼Œå®šä¹‰æ¸…æ™°æ¥å£ |
| æ€§èƒ½ä¸‹é™ | é«˜ | ä½ | æå‰è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œä¼˜åŒ–å…³é”®è·¯å¾„ |

### ä¸­é£é™©é¡¹

| é£é™©é¡¹ | å½±å“ | æ¦‚ç‡ | åº”å¯¹æªæ–½ |
|--------|------|------|----------|
| å…¼å®¹æ€§é—®é¢˜ | ä¸­ | ä¸­ | å……åˆ†æµ‹è¯•ï¼Œä¿ç•™å›æ»šæ–¹æ¡ˆ |
| å¼€å‘å‘¨æœŸå»¶é•¿ | ä¸­ | ä¸­ | ä¸¥æ ¼æ‰§è¡Œé˜¶æ®µè®¡åˆ’ï¼ŒåŠæ—¶è°ƒæ•´ |
| æµ‹è¯•è¦†ç›–ä¸è¶³ | ä¸­ | ä¸­ | è¡¥å……å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯• |

---

## å…­ã€å›æ»šç­–ç•¥

### è§¦å‘æ¡ä»¶
- é˜¶æ®µ 2-5 æ— æ³•æŒ‰æ—¶å®Œæˆ
- å‘ç°é‡å¤§è®¾è®¡ç¼ºé™·
- æ€§èƒ½ä¸¥é‡ä¸‹é™
- ç°æœ‰åŠŸèƒ½æ— æ³•æ¢å¤

### å›æ»šæ­¥éª¤
1. åœæ­¢é‡æ„å·¥ä½œ
2. æ¢å¤å¤‡ä»½æ–‡ä»¶ï¼ˆ`src/frontend/pet.py.backup`ï¼‰
3. ä¿ç•™å·²åˆ›å»ºçš„æ–°æ–‡ä»¶ä½œä¸ºå‚è€ƒ
4. åˆ†æé—®é¢˜åŸå› 
5. ä¿®å¤é—®é¢˜åé‡æ–°å¼€å§‹

---

## ä¸ƒã€é¢„æœŸæ”¶ç›Š

### å¯ç»´æŠ¤æ€§
- âœ… ä»£ç èŒè´£æ¸…æ™°ï¼Œæ˜“äºç†è§£
- âœ… ä¿®æ”¹åŠŸèƒ½ä¸å½±å“å…¶ä»–æ¨¡å—
- âœ… æ–°åŠŸèƒ½æ˜“äºæ‰©å±•

### å¯æµ‹è¯•æ€§
- âœ… æ¯ä¸ªæ¨¡å—å¯ç‹¬ç«‹æµ‹è¯•
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡æé«˜
- âœ… é›†æˆæµ‹è¯•æ›´å®¹æ˜“

### å¯æ‰©å±•æ€§
- âœ… æ˜“äºæ·»åŠ æ–°çš„æ¸²æŸ“å™¨
- âœ… æ˜“äºæ·»åŠ æ–°çš„ç®¡ç†å™¨
- âœ… æ˜“äºæ”¯æŒ Live2D

### æ€§èƒ½
- âœ… èµ„æºç®¡ç†æ›´ä¼˜åŒ–
- âœ… äº‹ä»¶å¤„ç†æ›´é«˜æ•ˆ
- âœ… å†…å­˜å ç”¨æ›´åˆç†

---

## å…«ã€è¿›åº¦è·Ÿè¸ª

### å·²å®Œæˆ
- [x] é˜¶æ®µ 1ï¼šåŸºç¡€æ¶æ„å‡†å¤‡ï¼ˆå‡è®¾å·²å®Œæˆï¼‰
- [ ] é˜¶æ®µ 2ï¼šæ¸²æŸ“ç³»ç»Ÿå®ç°
- [ ] é˜¶æ®µ 3ï¼šç®¡ç†å™¨å®ç°
- [ ] é˜¶æ®µ 4ï¼šä¸»çª—å£é‡æ„
- [ ] é˜¶æ®µ 5ï¼šé›†æˆæµ‹è¯•
- [ ] é˜¶æ®µ 6ï¼šæ–‡æ¡£å’Œæ¸…ç†

### å½“å‰çŠ¶æ€
- ğŸ“‹ å‡†å¤‡å¼€å§‹é‡æ„
- â³ ç­‰å¾…ç”¨æˆ·ç¡®è®¤æ–¹æ¡ˆ

### é¢„è®¡å®Œæˆæ—¶é—´
- é˜¶æ®µ 2ï¼š2-3 å¤©
- é˜¶æ®µ 3ï¼š3-4 å¤©
- é˜¶æ®µ 4ï¼š2-3 å¤©
- é˜¶æ®µ 5ï¼š1-2 å¤©
- é˜¶æ®µ 6ï¼š1 å¤©
- **æ€»è®¡ï¼š9-13 å¤©**

---

## ä¹ã€é™„å½•

### A. ç›¸å…³æ–‡æ¡£
- [a1-LIVE2D_REFACTORING_PLAN.md](./a1-LIVE2D_REFACTORING_PLAN.md) - é‡æ„è§„åˆ’æ–‡æ¡£
- [t1-TODOLIST.md](./t1-TODOLIST.md) - æ€»ä½“ä»»åŠ¡æ¸…å•
- [README.md](../README.md) - é¡¹ç›®è¯´æ˜

### B. å‚è€ƒèµ„æº
- [PyQt5 å®˜æ–¹æ–‡æ¡£](https://doc.qt.io/qt-5/)
- [Python æ¶æ„æ¨¡å¼](https://refactoring.guru/design-patterns/python)
- [å•ä¸€èŒè´£åŸåˆ™](https://en.wikipedia.org/wiki/Single-responsibility_principle)

---

**æ–‡æ¡£ç»“æŸ**
