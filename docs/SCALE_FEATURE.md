# 界面缩放功能说明

## 功能概述

桌面宠物现在支持全局界面缩放功能，可以根据需要调整整个界面的大小，包括：
- 桌面宠物本体
- 气泡消息
- 输入框
- 所有界面元素和字体

## 配置方法

### 方法一：通过配置文件设置

编辑 `config.toml` 文件，在 `[interface]` 部分设置缩放倍率：

```toml
[interface]
scale_factor = 1.0  # 界面缩放倍率
```

**可选的缩放倍率：**
- `0.5` - 50% 大小（最小）
- `0.75` - 75% 大小
- `1.0` - 100% 大小（默认）
- `1.25` - 125% 大小
- `1.5` - 150% 大小
- `2.0` - 200% 大小（最大）

**注意：** 缩放倍率限制在 0.5 到 3.0 之间。

### 方法二：通过右键菜单设置（推荐）

1. 右键点击桌面宠物
2. 选择 "🔍 缩放" 子菜单
3. 从预设的缩放选项中选择需要的倍率
4. 系统会自动保存配置并提示重启程序后生效

## 修改后如何生效

**重要：** 修改缩放倍率后需要重启程序才能生效！

1. 关闭当前运行的程序
2. 重新启动程序
3. 新的缩放倍率将应用于所有界面元素

## 使用场景

### 小屏幕设备
如果你的屏幕较小或分辨率较低，可以将缩放设置为 `0.5x` 或 `0.75x`，让界面更加紧凑。

### 高分辨率屏幕
如果使用 4K 等高分辨率屏幕，可以将缩放设置为 `1.5x` 或 `2.0x`，让界面元素更大更清晰。

### 视力需求
根据个人视力需求调整界面大小，确保文字和图标清晰可见。

## 技术实现细节

### 缩放倍率的应用范围

1. **桌面宠物窗口**
   - 窗口尺寸：400x600 × scale_factor
   - 宠物图片：按比例缩放
   - 边距和间距：按比例调整

2. **气泡消息**
   - 气泡大小：按比例缩放
   - 字体大小：按比例缩放
   - 图片缩略图：最大尺寸按比例调整
   - 圆角半径、箭头高度等：按比例调整

3. **输入框**
   - 输入框尺寸：按比例缩放
   - 字体大小：按比例缩放
   - 按钮尺寸：按比例缩放
   - 边距和间距：按比例调整

### 配置管理

- 配置存储在 `config.toml` 文件的 `[interface]` 部分
- 通过 `config.py` 中的 `scale_factor` 全局变量应用缩放
- 支持运行时修改配置，自动保存到文件

### 代码示例

```python
from config import scale_factor, get_scale_factor

# 获取当前缩放倍率
current_scale = get_scale_factor()  # 返回 0.5-3.0 之间的浮点数

# 应用缩放到尺寸
width = int(base_width * scale_factor)
height = int(base_height * scale_factor)

# 应用缩放到字体
font_size = int(12 * scale_factor)

# 应用缩放到边距
margin = int(10 * scale_factor)
```

## 注意事项

1. **重启生效**：修改缩放后必须重启程序才能看到效果
2. **范围限制**：缩放倍率被限制在 0.5-3.0 之间，超出范围的值会被自动调整
3. **性能影响**：较大的缩放倍率（如 2.0x 或 3.0x）可能会占用更多内存
4. **配置文件**：确保 `config.toml` 文件具有正确的 `[interface]` 配置节

## 故障排除

### 修改缩放后没有效果

1. 确认已重启程序
2. 检查 `config.toml` 文件是否正确保存
3. 确认 `[interface]` 配置节存在且 `scale_factor` 值有效

### 界面显示异常

1. 检查缩放倍率是否在合理范围内（0.5-3.0）
2. 尝试重置为默认值 1.0
3. 删除 `config.toml` 中的 `[interface]` 部分恢复默认设置

### 程序启动失败

1. 确认 `config.py` 中正确导入了 `scale_factor`
2. 检查是否有语法错误
3. 查看终端错误日志

## 更新日志

- **v1.0** (2026-01-05)
  - 添加全局界面缩放功能
  - 支持通过配置文件和右键菜单设置缩放
  - 应用缩放到所有界面元素
  - 提供 6 个预设缩放选项（0.5x 到 2.0x）
